apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: sonarr
spec:
  interval: 1m
  chart:
    spec:
      chart: ./charts/sonarr
      sourceRef:
        kind: GitRepository
        name: home-server
        namespace: {{ .Release.namespace }}
      interval: 1m
  values:
    ingress:
      annotations:
        cert-manager.io/cluster-issuer: letsencrypt-prod
        nginx.ingress.kubernetes.io/ssl-redirect: 'true'
        nginx.ingress.kubernetes.io/limit-rps: "5"
      ingressClassName: nginx-ext
      host: bazarr.nwallace.io
    pvc:
      enabled: true
      size: 2Gi
      storageClassName: longhorn
    volumes:
      - name: media
        persistentVolumeClaim:
          claimName: media
    volumeMounts:
      - name: media
        mountPath: /media
    resources:
      limits:
        memory: 2048M